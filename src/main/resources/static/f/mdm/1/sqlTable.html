<div> mc-sql-design
    <div class="w3-right w3-white w3-border-bottom w3-hover-shadow w3-dropdown-hover">
        <svg width="18" x="0px" y="0px" viewBox="0 0 115.28 122.88" style="enable-background:new 0 0 115.28 122.88">
            <g>
                <path style="fill-rule: evenodd; clip-rule: evenodd;"
                    d="M25.38,57h64.88V37.34H69.59c-2.17,0-5.19-1.17-6.62-2.6c-1.43-1.43-2.3-4.01-2.3-6.17V7.64l0,0H8.15 c-0.18,0-0.32,0.09-0.41,0.18C7.59,7.92,7.55,8.05,7.55,8.24v106.45c0,0.14,0.09,0.32,0.18,0.41c0.09,0.14,0.28,0.18,0.41,0.18 c22.78,0,58.09,0,81.51,0c0.18,0,0.17-0.09,0.27-0.18c0.14-0.09,0.33-0.28,0.33-0.41v-11.16H25.38c-4.14,0-7.56-3.4-7.56-7.56 V64.55C17.82,60.4,21.22,57,25.38,57L25.38,57z M29.57,83.94l7.12-0.45c0.15,1.15,0.47,2.03,0.94,2.63 c0.77,0.98,1.87,1.47,3.31,1.47c1.07,0,1.89-0.25,2.47-0.75c0.58-0.5,0.87-1.08,0.87-1.75c0-0.63-0.27-1.19-0.82-1.69 c-0.55-0.5-1.82-0.96-3.83-1.41c-3.29-0.73-5.62-1.72-7.03-2.94c-1.41-1.22-2.12-2.78-2.12-4.68c0-1.24,0.36-2.42,1.08-3.52 c0.72-1.11,1.81-1.98,3.26-2.61c1.45-0.63,3.44-0.95,5.96-0.95c3.1,0,5.46,0.58,7.09,1.73c1.63,1.15,2.59,2.99,2.9,5.51l-7.05,0.42 c-0.19-1.1-0.58-1.9-1.18-2.4c-0.6-0.5-1.43-0.75-2.49-0.75c-0.87,0-1.53,0.19-1.97,0.55c-0.44,0.37-0.66,0.82-0.66,1.35 c0,0.38,0.18,0.73,0.54,1.04c0.34,0.32,1.18,0.62,2.5,0.89c3.28,0.71,5.62,1.42,7.03,2.15c1.42,0.72,2.45,1.62,3.09,2.69 c0.64,1.07,0.97,2.26,0.97,3.59c0,1.55-0.43,2.99-1.29,4.3c-0.86,1.31-2.06,2.31-3.61,2.99c-1.54,0.68-3.48,1.02-5.83,1.02 c-4.12,0-6.98-0.8-8.57-2.38C30.68,88.41,29.78,86.39,29.57,83.94L29.57,83.94z M76.38,88.41c0.93,0.65,1.54,1.06,1.83,1.23 c0.42,0.24,1.01,0.53,1.73,0.85l-2.07,4.2c-1.04-0.51-2.08-1.11-3.11-1.81c-1.03-0.7-1.75-1.23-2.15-1.58 c-1.65,0.72-3.73,1.08-6.22,1.08c-3.69,0-6.6-0.96-8.73-2.88c-2.52-2.27-3.78-5.46-3.78-9.57c0-3.99,1.1-7.09,3.3-9.31 c2.2-2.21,5.27-3.32,9.23-3.32c4.03,0,7.13,1.08,9.32,3.24c2.19,2.16,3.29,5.25,3.29,9.27C79.02,83.4,78.14,86.26,76.38,88.41 L76.38,88.41z M70.63,84.56c0.6-1.07,0.9-2.67,0.9-4.79c0-2.45-0.46-4.19-1.37-5.24c-0.92-1.04-2.17-1.57-3.77-1.57 c-1.5,0-2.71,0.54-3.63,1.6c-0.93,1.07-1.39,2.74-1.39,5.01c0,2.65,0.45,4.51,1.36,5.57c0.91,1.07,2.15,1.6,3.73,1.6 c0.51,0,0.99-0.05,1.44-0.15c-0.63-0.61-1.63-1.18-2.99-1.72l1.17-2.69c0.67,0.12,1.19,0.27,1.55,0.45 c0.37,0.17,1.1,0.64,2.17,1.39C70.06,84.2,70.33,84.38,70.63,84.56L70.63,84.56z M82.55,67.71h7.49V86h11.72v5.96H82.55V67.71 L82.55,67.71z M97.79,57h9.93c4.16,0,7.56,3.41,7.56,7.56v31.42c0,4.15-3.41,7.56-7.56,7.56h-9.93v13.55c0,1.61-0.65,3.04-1.7,4.1 c-1.06,1.06-2.49,1.7-4.1,1.7c-29.44,0-56.59,0-86.18,0c-1.61,0-3.04-0.64-4.1-1.7c-1.06-1.06-1.7-2.49-1.7-4.1V5.85 c0-1.61,0.65-3.04,1.7-4.1c1.06-1.06,2.53-1.7,4.1-1.7h58.72C64.66,0,64.8,0,64.94,0c0.64,0,1.29,0.28,1.75,0.69h0.09 c0.09,0.05,0.14,0.09,0.23,0.18l29.99,30.36c0.51,0.51,0.88,1.2,0.88,1.98c0,0.23-0.05,0.41-0.09,0.65V57L97.79,57z M67.52,27.97 V8.94l21.43,21.7H70.19c-0.74,0-1.38-0.32-1.89-0.78C67.84,29.4,67.52,28.71,67.52,27.97L67.52,27.97z" />
            </g>
        </svg>
        &nbsp; &nbsp; ::
        <div class="w3-dropdown-content w3-border" style="left: -220px;min-width: 275px;">
            menu:
            <button class="w3-btn w3-padding-small"
                data-ng-click="ctrl.singlePage.session.menuSqls=!ctrl.singlePage.session.menuSqls">
                sqls
            </button>
            <div class="w3-leftbar" data-ng-if="ctrl.singlePage.session.menuSqls">
                <a title="{{sqlName}}" class="am-0u" href="#!/sql_{{sqlName}}" data-ng-if="ctrl.getSql(sqlName).sql"
                    data-ng-repeat="sqlName in ctrl.sqlNames()">
                    <div data-ng-class="{'w3-green':ctrl.singlePage.session.sql==sqlName}" class="w3-hover-shadow">
                        {{sqlName}} </div>
                </a>
                &nbsp;
            </div>
            <div>
                <span class="w3-tiny am-b">parent:</span>
                <a class="w3-btn w3-padding-small am-0u" data-ng-class="{
                    'w3-green':ctrl.singlePage.session.tree.l.selectedId
                ==ctrl.singlePage.session.sqlValue
            }" href="#!/sql_{{ctrl.singlePage.session.sql}}/parent={{
                    ctrl.singlePage.session.tree.l.selectedId}}_l">L</a>|
                <a class="w3-btn w3-padding-small am-0u" data-ng-class="{
                    'w3-green':ctrl.singlePage.session.tree.r.selectedId
                ==ctrl.singlePage.session.sqlValue
            }" href="#!/sql_{{ctrl.singlePage.session.sql}}/parent={{
                    ctrl.singlePage.session.tree.r.selectedId}}_r">R</a>
                <span class="w3-btn w3-padding-small" data-ng-click="ctrl.delSqlKeyValue()"
                    data-ng-if="ctrl.singlePage.session.sqlValue">
                    ⌫
                </span>
            </div>
        </div>
    </div>
    <span class="w3-small"> {{ctrl.date | date:'medium'}} </span>
    <span class="w3-tiny am-b"> {{ctrl.singlePage.session.sql
        }}<span data-ng-if="ctrl.singlePage.session
        .sqlKey">/{{ctrl.singlePage.session.sqlKey
            }}={{ctrl.singlePage.session.sqlValue}}</span>
    </span>
    {{ctrl.getSql(ctrl.singlePage.session.sql).name}}
    <div data-ng-if="true||ctrl.conf.eMap[ctrl.singlePage.session.tree.l.selectedId].reference==369358">
        <span class="w3-hover-shadow w3-dropdown-hover w3-white w3-border-top">
            <svg width="18" viewBox="0 0 122.88 121.83">
                <path
                    d="M102.42,37H81.92a8.52,8.52,0,0,1-8.85-8.7V7.53H21a.58.58,0,0,0-.41.18.45.45,0,0,0-.18.42V113.71a.7.7,0,0,0,.18.41.51.51,0,0,0,.41.18h80.84c.18,0,.17-.09.26-.18s.34-.28.34-.41V37Zm7.47,79.08a5.77,5.77,0,0,1-5.76,5.76H18.66a5.77,5.77,0,0,1-5.76-5.76V5.76a5.7,5.7,0,0,1,1.69-4.07A5.77,5.77,0,0,1,18.66,0H76.9a4.22,4.22,0,0,1,2.46.82l29.75,30.12a2.57,2.57,0,0,1,.78,2.6v82.53ZM80,27.69,79.57,9.63,100.66,31l-18.14-.81A2.4,2.4,0,0,1,80,27.69Z">
                </path>
                <path style="fill: red; fill-rule: evenodd;"
                    d="M6.71,46.28H116.17A6.73,6.73,0,0,1,122.88,53v45.1a6.73,6.73,0,0,1-6.71,6.71H6.71A6.73,6.73,0,0,1,0,98.09V53a6.73,6.73,0,0,1,6.71-6.71Z">
                </path>
                <path style="fill: #fff;"
                    d="M13.88,79.38l9.25-.58a7,7,0,0,0,1.22,3.42,5.18,5.18,0,0,0,4.3,1.91,4.76,4.76,0,0,0,3.21-1,2.82,2.82,0,0,0,.07-4.46c-.71-.65-2.37-1.25-5-1.83q-6.4-1.42-9.13-3.82A7.69,7.69,0,0,1,15.07,67a8.25,8.25,0,0,1,1.41-4.58A9.4,9.4,0,0,1,20.71,59a19.89,19.89,0,0,1,7.75-1.23q6,0,9.21,2.25c2.12,1.5,3.37,3.89,3.78,7.16l-9.16.54a5,5,0,0,0-1.54-3.12,4.9,4.9,0,0,0-3.23-1,3.91,3.91,0,0,0-2.56.72,2.17,2.17,0,0,0-.86,1.75,1.76,1.76,0,0,0,.69,1.35,7.84,7.84,0,0,0,3.26,1.16,40.6,40.6,0,0,1,9.13,2.79,9.58,9.58,0,0,1,4,3.49,8.84,8.84,0,0,1,1.26,4.67,10.06,10.06,0,0,1-1.67,5.59A10.57,10.57,0,0,1,36.1,89a18.94,18.94,0,0,1-7.58,1.32q-8,0-11.14-3.09a12.19,12.19,0,0,1-3.5-7.86Zm61.48,5.8c1.21.85,2,1.38,2.37,1.6.55.31,1.31.68,2.25,1.1l-2.69,5.45a31.53,31.53,0,0,1-4-2.35,33.43,33.43,0,0,1-2.8-2,20.4,20.4,0,0,1-8.08,1.4q-7.18,0-11.34-3.74-4.91-4.43-4.91-12.44c0-5.19,1.43-9.21,4.29-12.09s6.86-4.31,12-4.31,9.27,1.4,12.12,4.21S78.79,68.79,78.79,74q0,7-3.43,11.17Zm-7.47-5A13.09,13.09,0,0,0,69.06,74q0-4.76-1.78-6.81a6.17,6.17,0,0,0-4.9-2,6,6,0,0,0-4.72,2.09q-1.81,2.09-1.81,6.51,0,5.16,1.76,7.24A6,6,0,0,0,62.46,83a8.65,8.65,0,0,0,1.87-.2,12.19,12.19,0,0,0-3.89-2.23L62,77.1a7.89,7.89,0,0,1,2,.58,23.84,23.84,0,0,1,2.82,1.8c.33.23.69.46,1.08.71ZM84,58.28h9.73V82.06H109v7.75H84V58.28Z">
                </path>
            </svg>⇋<a class=" w3-text-blue " href="https://cql.hl7.org/" target="_blank"
                title="Clinical Query Language">CQL</a>

            <div class="w3-dropdown-content w3-border w3-leftbar am-max-width-1">
                <pre class="w3-tiny">{{ctrl.getSql(ctrl.singlePage.session.sql).sql}}</pre>
            </div>
        </span>
        <span class="w3-dropdown-hover">
            <button class="w3-btn w3-padding-small w3-border w3-white w3-left-align" style="width: 275px;"
                data-ng-click="ctrl.getSql('autoSql').createSessioSql()">
                autoSql: {{ctrl.singlePage.session.sql}}
            </button>
            <div class="w3-dropdown-content w3-card-4 w3-leftbar w3-container w3-small" style="width: 550px;">
                <div class="w3-row">
                    <div class="w3-twothird"> subSQL:
                        <button class="w3-hover-shadow  w3-left-align w3-border" data-ng-class="{
                            'w3-green':fale, 'w3-white':true,}" data-ng-click="ctrl.getSql('autoSql')
                            ['create'+actName]()" data-ng-repeat="actName in [
                            'TableRow2AdnSql',
                            'TableA1Row2AdnSql',
                            'RowAdnSql','AdnSql','R2ValueSql']">{{actName}}</button>
                        <br> <br>
                        <div>
                            <div class="w3-hover-shadow"
                                data-ng-click="ctrl.singlePage.session.sqlSelectedColumnId=null">
                                pattern
                            </div>
                            <div class="w3-container w3-border-left">
                                <div data-ng-repeat="(k,v) in ctrl.getSql(ctrl.singlePage.session.sql).columns"
                                    data-ng-click="ctrl.singlePage.session.sqlSelectedColumnId=k"
                                    data-ng-class="{'w3-blue':ctrl.singlePage.session.sqlSelectedColumnId==k}"
                                    class="w3-hover-shadow">
                                    {{v.sqlName}}_{{k}}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="w3-third">
                        autoSqls:
                        <div class="w3-row">
                            <div data-ng-repeat="sqlName in ctrl.getSqlAppNames()"
                                data-ng-if="(sqlName.includes('Sql_')||sqlName.includes('Adn_'))
                            &&(!ctrl.singlePage.session.sqlSelectedColumnId||sqlName.includes(ctrl.singlePage.session.sqlSelectedColumnId))">
                                <div class="w3-col" style="width:20px">
                                    <span data-ng-if="ctrl.singlePage.session.sqlSelectedColumnId">
                                        <button data-ng-click="ctrl.setSessionTableColumnSqlName(sqlName)"
                                            class="w3-hover-shadow w3-left-align w3-border"> ← </button>
                                    </span>
                                </div>
                                <div class="w3-rest">
                                    <button data-ng-click="ctrl.singlePage.session.sql=sqlName"
                                        class="w3-hover-shadow w3-left-align w3-border" data-ng-class="{
                                                'w3-green':ctrl.singlePage.session.sql==sqlName,
                                                'w3-white':ctrl.singlePage.session.sql!=sqlName,}">
                                        {{sqlName}}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </span>
        <span data-ng-if="ctrl.rowSql||ctrl.getSql('autoSql').sql"> |
            <span class="w3-dropdown-hover">
                <button class="w3-btn w3-padding-small w3-white w3-border" data-ng-click="ctrl.exeSql()">play&nbsp;<i
                        class="fas fa-play"></i></button>
                <div class="w3-dropdown-content w3-card-4 w3-leftbar w3-container">
                    parent:
                    <input class="w3-border" data-ng-model="ctrl.getSql(ctrl.singlePage.session.sql).parentIn">
                    &nbsp;
                </div>
            </span>
            <button class="w3-btn w3-padding-small w3-border" data-ng-click="ctrl.editRow()">edit&nbsp;<i
                    class="fas fa-edit"></i></button>
            <button class="w3-btn w3-padding-small w3-border" data-ng-click="ctrl.buildSqlApp()">sql-app&nbsp;<i
                    class="fas fa-pen"></i></button>
        </span>
        <pre class="w3-small">{{ctrl.add_sql_app}}</pre>
        <div data-ng-if="ctrl.singlePage.session.CRUD == 'U'" class="w3-card-4" data-ng-include="'editRow.html'">
        </div>
        <pre data-ng-if="!ctrl.singlePage.session.CRUD || ctrl.singlePage.session.CRUD == 'R'" class="w3-tiny"
            style="max-height: 5vh; overflow: auto; ">{{ctrl.getSql(ctrl.singlePage.session.sql).sql}}</pre>
    </div>
    <table>
        <thead class="w3-blue-gray w3-tiny">
            <tr>
                <th data-ng-if="!ctrl.sql_app[ctrl.conf.sqlKeyName].noShow.includes(k)"
                    data-ng-repeat="(k,v) in ctrl.conf.sqlTableData[0]"> {{k}} </th>
            </tr>
        </thead>
        <tbody>
            <tr data-ng-click="(ctrl.singlePage.session.selectedRowId = r[ctrl.getSql(ctrl.singlePage.session.sql).rowId]||r.doc_id) && ctrl.clickRow(r)"
                data-ng-class="{'w3-card w3-light-green':ctrl.isSelectedRow(r)}" class="w3-hover-shadow"
                data-ng-repeat="r in ctrl.conf.sqlTableData">
                <td data-ng-if="!ctrl.sql_app[ctrl.conf.sqlKeyName].noShow.includes(k)"
                    data-ng-repeat="(k,v) in ctrl.conf.sqlTableData[0]" data-am:sql:html>{{r[k]}}</td>
            </tr>
        </tbody>
    </table>
</div>